(()=>{"use strict";var e={192:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Indie+Flower&display=swap);"]),r.push([e.id,'button{cursor:pointer}h1{font-family:"Indie Flower",cursive;font-size:50px;cursor:pointer}#header_wrapper #sub_region{overflow:scroll;display:flex;height:110px}#header_wrapper #sub_region .subregion{width:max-content;height:50px;font-size:32px;line-height:40px;flex:none}#header_wrapper #sub_region .content_wrap{display:flex}#header_wrapper #sub_region .info{font-size:12px}#game_wrapper{width:100%;height:600px;position:absolute}#game_wrapper #worldmap{position:absolute;width:94%;height:570px;margin:0 3%;border:5px solid #fff5ee;box-shadow:5px 5px 15px #000;border-radius:15px}#game_wrapper #worldmap #name_switch{position:relative;z-index:1000;left:5%;margin-top:10px}#game_wrapper #worldmap #start_btn{position:relative;z-index:1000;left:72%;width:170px}#game_wrapper #worldmap #menue_btn{z-index:1000;position:relative;left:73%;font-size:28px}#game_wrapper #minimap{left:2%;top:67%;width:23%;height:180px;position:relative;z-index:1000;border:1px solid #000;box-shadow:0px 0px 10px #000;border-radius:5px}#game_wrapper #cauntry_flag_wrapper{display:flex;flex-direction:column;flex-wrap:wrap;align-items:flex-end;align-content:flex-end;position:relative;z-index:1000;height:480px;margin-left:89%;margin-top:10px}#game_wrapper #cauntry_flag_wrapper .flag_pic{margin-top:5px;margin-right:15px;max-width:60px;height:40px;cursor:pointer}.result_flag{margin-top:5px;margin-right:15px;max-width:60px;height:40px;cursor:pointer}.modal-content{width:150%;left:-25%}.clicked{border:4px solid red;box-shadow:0px 4px 6px #000;margin-bottom:4px}.corrected{visibility:hidden}',""]);const a=r},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var i=0;i<e.length;i++){var s=[].concat(e[i]);o&&r[s[0]]||(n&&(s[2]?s[2]="".concat(n," and ").concat(s[2]):s[2]=n),t.push(s))}},t}},379:(e,t,n)=>{var o,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function l(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function i(e,t){for(var n={},o=[],r=0;r<e.length;r++){var i=e[r],s=t.base?i[0]+t.base:i[0],c=n[s]||0,p="".concat(s," ").concat(c);n[s]=c+1;var d=l(p),u={css:i[1],media:i[2],sourceMap:i[3]};-1!==d?(a[d].references++,a[d].updater(u)):a.push({identifier:p,updater:f(u,t),references:1}),o.push(p)}return o}function s(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var a=n.nc;a&&(o.nonce=a)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var l=r(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(t)}return t}var c,p=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=p(t,r);else{var a=document.createTextNode(r),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(a,l[t]):e.appendChild(a)}}function u(e,t,n){var o=n.css,r=n.media,a=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var g=null,m=0;function f(e,t){var n,o,r;if(t.singleton){var a=m++;n=g||(g=s(t)),o=d.bind(null,n,a,!1),r=d.bind(null,n,a,!0)}else n=s(t),o=u.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=i(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=l(n[o]);a[r].references--}for(var s=i(e,t),c=0;c<n.length;c++){var p=l(n[c]);0===a[p].references&&(a[p].updater(),a.splice(p,1))}n=s}}}}},t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=n(379),t=n.n(e),o=n(192);t()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;const r=[35.681,0],a=L.map("worldmap").setView(r,2),l=L.map("minimap",{zoomControl:!1}).setView(r,0),i=()=>L.tileLayer("http://{s}.tile.stamen.com/{variant}/{z}/{x}/{y}.png",{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>',variant:"toner-lite"});document.getElementById("title").addEventListener("click",(()=>a.setView(r,2))),window.onload=(i().addTo(a),void i().addTo(l));const s=document.getElementById("myChart").getContext("2d"),c={南アジア:{postion:0},北ヨーロッパ:{postion:1},南ヨーロッパ:{postion:1},北アフリカ:{postion:3},ポリネシア:{postion:6},中央アフリカ:{postion:3},カリブ海:{postion:6},"":{postion:0},南アメリカ:{postion:2},西アジア:{postion:0},オーストラリア:{postion:5},西ヨーロッパ:{postion:1},東ヨーロッパ:{postion:1},中央アメリカ:{postion:2},西アフリカ:{postion:3},北アメリカ:{postion:1},南部アフリカ:{postion:3},東アフリカ:{postion:3},東南アジア:{postion:0},東アジア:{postion:0},メラネシア:{postion:6},ミクロネシア:{postion:6},中央アジア:{postion:0}},p=document.getElementById("sub_region"),d=document.getElementById("start_btn"),u=document.getElementById("name_switch"),g=document.getElementById("cauntry_flag_wrapper"),m=document.getElementById("result_close"),f=document.getElementById("collection"),h=document.getElementsByClassName("leaflet-popup-pane");let b,v,x=null,y=null,w=[],_=!1,C=!1;const E="https://restcountries.eu/rest/v2/";fetch(E+"all").then((e=>e.json())).then((e=>{for(let t=0;t<e.length;t++){const n=J("span",[["class","result_flag"],["name",e[t].flag]],e[t].translations.ja,!1),o=localStorage.getItem(`${e[t].translations.ja} src`);console.log(JSON.stringify(o)),n.getAttribute("name")===o?J("img",[["src",o],["class","result_flag"]],!1,f):f.appendChild(n)}const t=B(e);N(t).forEach((e=>{p.appendChild(e)})),(e=>{const t=Object.keys(e).sort(((t,n)=>e[t].postion-e[n].postion)).filter((e=>0!==e.length)),n=t.map((e=>localStorage.getItem(`${e} challengeCount`))),o=t.map((e=>localStorage.getItem(`${e} clearCount`)));new Chart(s,{type:"bar",data:{labels:t,datasets:[{label:"テストにチャレンジした回数",backgroundColor:"#17a2b8",borderColor:"#17a2b8",data:n},{label:"テストをクリアした回数",backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:o}]},options:{}})})(c),[...h].forEach((e=>{e.style.visibility="hidden"}))})),m.addEventListener("click",(()=>{const e=document.getElementById("result");O(e)})),u.addEventListener("click",(()=>H())),d.addEventListener("click",(()=>{if(_){if(confirm("テストをあきらめて地域選択にもどりますか？")){P("テストにチャレンジ"),j();const e=parseInt(localStorage.getItem(`${v} challengeCount`))-1;return void localStorage.setItem(`${v} challengeCount`,e)}return}if(0===w.length)return void alert("地域を選択してください");if(localStorage[`${v} challengeCount`]){const e=parseInt(localStorage.getItem(`${v} challengeCount`))+1;localStorage.setItem(`${v} challengeCount`,e)}else localStorage.setItem(`${v} challengeCount`,1);M(w);const e=document.querySelectorAll(".leaflet-marker-icon"),t=document.querySelectorAll(".flag_pic");e.forEach((e=>{e.setAttribute("src","https://unpkg.com/leaflet@1.4.0/dist/images/marker-icon-2x.png"),e.style.width="30px",e.style.height="30px"})),P("もどる");const n=[...e,...t];S(n)})),p.addEventListener("click",(e=>{if("subregion"!==e.target.className.split(" ")[0])return;if(_)return;w.forEach((e=>{e.closePopup()})),O(g),v=e.target.textContent;const t=e.target.id.replace(/_/g," ");fetch(E+"subregion/"+t).then((e=>e.json())).then((e=>z(T(e)))).then((e=>{console.time("test");const t=e.map((e=>F([e.latlng[0],e.latlng[1]],e.translations.ja,"link")));console.timeEnd("test"),w=t;let n=null,o=null;t.forEach((e=>{n+=e._latlng.lat,o+=e._latlng.lng,e.addTo(a)})),a.setView([n/t.length,o/t.length],4);const r=V(n/t.length,o/t.length);return b=r,r.addTo(l),e})).then((e=>{document.querySelectorAll(".leaflet-marker-icon").forEach(((t,n)=>{t.classList.add(e[n].latlng.join("_")),t.setAttribute("src",e[n].flag),t.style.width="60px",t.style.height="40px"}))}))}));const S=e=>{if(_=!0,x=10,x===e.length/2||10===x)return void k(e);let t=[];e.forEach((n=>{n.onclick=n=>{const o=n.target.className.split(" ")[0],r=n.target.className.split(" ")[3];1===t.length&&t[0][0]===o||"corrected"===n.target.getAttribute("name")||(n.target.classList.add("clicked"),t.push([o,r,n.target]),2===t.length&&I(t,e))}}))},I=(e,t)=>{if(e[0][1]===e[1][1]){console.log("正解！");const t=q(e).markerDom,n=q(e).flagSrc,o=q(e).flagDom;setTimeout((()=>{D("clicked",!1),o.classList.add("corrected"),t.setAttribute("name","corrected"),t.setAttribute("src",n),t.style.width="40px",t.style.height="30px"}),1e3),x++,console.log(x)}else console.log("間違い"),setTimeout((()=>D("clicked",!1)),1e3),y++,console.log(y);e.length=0,S(t)},k=e=>{if(_=!1,P("テストにチャレンジ"),localStorage[`${v} clearCount`]){const e=parseInt(localStorage.getItem(`${v} clearCount`))+1;localStorage.setItem(`${v} clearCount`,e)}else localStorage.setItem(`${v} clearCount`,1);const t=e.filter((e=>"flag_pic"===e.className.split(" ")[0]));console.log(t[0].getAttribute("name"));const n=t.map((e=>e.getAttribute("src"))),o=t.map((e=>e.getAttribute("name")));console.log(n,o);const r=document.getElementById("clearMsg");return $("#result_modal").modal(),console.log(y),y?y<=5?(A(n,o,5),r.textContent="Get two flags!",void j()):y<=3?(A(n,o,3),r.textContent="Get three flags!",void j()):(A(n,o,1),r.textContent="Get one flags!",void j()):(A(n,o,n.length),r.textContent="Get all flags!",void j())},A=(e,t,n)=>{const o=document.getElementById("result");for(let r=0;r<n;r++)J("img",[["src",e[r]],["alt",t[r]],["class","result_flag"]],!1,o),localStorage.setItem(`${t[r]} src`,e[r])},j=()=>{_=!1,x=0,y=0,O(g),w.length=0},B=e=>{const t=new Map;return e.forEach((e=>{if(t.has(e.subregion)){const n=t.get(e.subregion);t.set(e.subregion,parseInt(n+1))}else t.set(e.subregion,1)})),t},N=e=>{let t=0,n=[],o=Object.keys(c),r=[];return e.forEach(((e,a)=>{if(n.push(a.replace(a,o[t])),a){const l=J("div",["class","select_btn my-1 mr-3 "+c[o[t]].postion],!1,!1);J("button",[["id",`${a.replace(/\s+/g,"_")}`],["class","subregion btn btn-dark py-1 px-3"]],n[t],l);const i=J("div",["class","content_wrap m-0 p-0"],!1,l);J("p",["class","cauntry_count subregion_content m-0 p-0"],`${e}カ国`,i),J("p",["class","level subregion_content m-0 p-0"],"",i),J("a",[["class","info subregion_content m-0 p-0"],["href","#"]],`${n[t]}を調べる`,l),r.push(l)}t++})),r.sort(((e,t)=>e.className.split(" ")[3]-t.className.split(" ")[3]))},T=e=>{let t=[];return e.forEach((e=>{void 0===e.latlng[0]&&void 0===e.latlng[1]||t.push({name:e.name,flag:e.flag,latlng:[e.latlng[0],e.latlng[1]],translations:e.translations})})),t},M=e=>{console.log(e[0]);for(let t=0;t<10;t++){if(t>=e.length)return;J("img",[["src",e[t]._icon.currentSrc],["class",`flag_pic _ _ ${e[t]._latlng.lat}_${e[t]._latlng.lng}`],["name",e[t]._tooltip._content]],!1,g)}},z=([...e])=>{let t=e.length;for(;t;){const n=Math.floor(Math.random()*t--);console.log(n),[e[t],e[n]]=[e[n],e[t]]}return e},O=(...e)=>{w&&G(w),b&&Z(b),e.forEach((e=>{for(;e.firstChild;)e.removeChild(e.firstChild)}))},D=(e,t)=>{const n=document.querySelectorAll(`.${e}`);n.forEach((t=>t.classList.remove(e))),t&&n.forEach((e=>e.classList.add(t)))},q=e=>"flag_pic"!==e[0][0]?{markerDom:e[0][2],markerSrc:e[0][2].getAttribute("src"),flagDom:e[1][2],flagSrc:e[1][2].getAttribute("src")}:{markerDom:e[1][2],markerSrc:e[1][2].getAttribute("src"),flagDom:e[0][2],flagSrc:e[0][2].getAttribute("src")},P=e=>{"もどる"===e?(d.textContent=e,d.classList.remove("btn-info"),d.classList.add("btn-danger")):"テストにチャレンジ"===e&&(d.textContent=e,d.classList.remove("btn-danger"),d.classList.add("btn-info"))},F=(e,t,n)=>{const o=[],r=[],a=[];return r[0]=e,a[0]=t,o[0]=L.marker([r[0][0],r[0][1]]),o[0].bindTooltip(a[0],{permanent:!0}).openTooltip(),o[0].bindPopup(a[0]).openPopup(),o[0]},G=e=>{e.forEach((e=>{a.removeLayer(e)}))},V=(e,t)=>(b&&Z(b),L.circle([e,t],{radius:2e6,color:"red",fillColor:"pink",fillOpacity:.5})),Z=e=>{l.removeLayer(e)},H=()=>{if(0===w.length)return;const e=document.getElementsByClassName("leaflet-tooltip");return C?([...e].forEach((e=>{e.style.visibility="visible"})),[...h].forEach((e=>{e.style.visibility="hidden"})),void(C=!1)):C?void 0:([...e].forEach((e=>{e.style.visibility="hidden"})),[...h].forEach((e=>{e.style.visibility="visible"})),void(C=!0))},J=(e,t,n,o)=>{const r=document.createElement(e);if(!1!==t){if("object"!=typeof t)return void console.error('第２引数は配列、ペアでお願いします[attribute, attributeName]\n属性やテキストが必要ないときは"false"を入れてください');"object"==typeof t[0]?t.forEach((e=>{r.setAttribute(e[0],e[1])})):r.setAttribute(t[0],t[1])}return!1!==n&&(r.textContent=n),o&&o.appendChild(r),r}})()})();